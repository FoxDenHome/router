{% set wgconf = custom.iface.cfg.wireguard %}
[Interface]
PrivateKey = {{ wgconf.private_key }}
Address = {{ " ".join(custom.iface.addresses) }}
ListenPort = {{ wgconf.port }}

{% for peer in wgconf.peers %}
[Peer]
PublicKey = {{ peer.public_key }}
AllowedIPs = {{ " ".join(peer.allowed_ips) }}
{% if peer.endpoint is defined %}
Endpoint = {{ peer.endpoint }}
{% endif %}
{% if peer.persistent_keepalive is defined %}
PersistentKeepalive = {{ peer.persistent_keepalive }}
{% endif %}
{% endfor %}
